volatile int flag1 = 0, flag2 = 0, turn = 0;

void * thr1(void * arg)
{
  while (1) {
  	flag1 = 1;__asm volatile ("dsb":::"memory");__asm volatile ("dsb":::"memory");
  	while(flag2 >= 1){
    		if(!(turn == 0))
      		{
        		flag1 = 0;__asm volatile ("dsb":::"memory");__asm volatile ("dsb":::"memory");
       	 		while(!(turn == 0)){;}
        		flag1 = 1;__asm volatile ("dsb":::"memory");__asm volatile ("dsb":::"memory");
      		}
	}
  	turn = 1;__asm volatile ("dsb":::"memory");
  	flag1 = 0;__asm volatile ("dsb":::"memory");
  }
}

void * thr2(void * arg)
{
  while (1) {
  	flag2 = 1;__asm volatile ("dsb":::"memory");__asm volatile ("dsb":::"memory");
  	while(flag1 >= 1){
    		if(!(turn == 1))
      		{
        		flag2 = 0;__asm volatile ("dsb":::"memory");__asm volatile ("dsb":::"memory");
        		while(!(turn == 1)){;}
        		flag2 = 1;__asm volatile ("dsb":::"memory");
      }}
  turn = 1;__asm volatile ("dsb":::"memory");
  flag2 = 0;
 }
}


int main()
{
  __CPROVER_ASYNC_0: thr1(0);
  __CPROVER_ASYNC_1: thr2(0);
//thr2(0);

return 0;
}

